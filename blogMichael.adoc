eBay Techblog - Mobile Test Automation
======================================
:author: Michael Palotas
:email:  michael.palotas@gridfusion.net
:toc:
:icons:
:lang: en
:encoding: iso-8859-1

This document is an introduction to mobile test automation based on Selenium.

== Introduction

=== The mobile experience and the impact on test automation

The web has seen a dramatic change over the past few years with mobile becoming a big part of the overall experience.
Test automation is a key enabler for agile software development and subsequently for continuous integration and delivery.
Many software companies are suddenly challenged with having to provide a solid test automation not only for the web but also for mobile with its two flavors mobile web and native apps.

Especially with the onset of mobile commerce and more and more transactions being made on mobile devices, the topic of test automation in the mobile space has gained huge significance.
While in the past customers started and finished a transaction either on the web or on mobile, now there is an increasing trend to "move" between platforms. This means they may start
a transaction on the web and finish on mobile or vice versa.

This calls for the same robust and scalable test automation approach for mobile as for the web. Ideally the solution for mobile integrates seamlessly with the web solution so that the movement of users between platforms and devices
can easily be recreated as part of an automated test.
Due to the great success and experience with using Selenium for web automation, companies like eBay decided to develop "Selenium for mobile" solutions which namely resulted in the creation of two open source projects: link:http://www.selendroid.io[selendroid] and link:http://ios-driver.github.io/ios-driver[ios-driver].

.The high level requirements that went into the creation of Selendroid and ios-driver were as follows

* reuse of the existing Selenium infrastructure for the web
* implementation of the Selenium protocol (JSON wire protocol)
* the application under test (aut) should not need to be modified
* execution of tests on emulators/simulators and real devices without changing the test itself
* parallel execution of tests in a Selenium Grid
* management of multiple applications, versions, languages
* support for runtime inspection for the app
* hybrid app support
* no jailbreaking of device required

=== A quick word on Selenium

In case you are not familiar with Selenium, here's a very brief introduction to it.

==== What is Selenium?
Selenium originally is a tool to automate web browsers. The JSON Wire Protocol (https://code.google.com/p/selenium/wiki/JsonWireProtocol) describes user interactions with a browser.
Each browser has a specific driver which is a native implementation for that specific browser. Selenium is a classic client / server architecture.
The client side is decoupled from the driver (server). From a client perspective, the commands to interact with the browser are the same, regardless which browser is used.

.High-level Selenium architecture
image:./images/seleniumClientServer.png[
"My screenshot",width=480,
link="./images/seleniumClientServer.png"]

.Selenium supports the following programming languages (client bindings):

* Java
* C#
* Python
* Ruby
* Perl
* PHP
* JavaScript

==== Selenium Grid

End-To-End tests are very expensive in terms of execution time and computing resources. Besides starting a browser, the whole flow of a user needs to be tested (i.e. sign in, search for something, buy it, pay).
This can take 2-3 minutes - even in an automated fashion. Considering that larger web applications may require hundreds, if not thousands of End-To-End Tests, the execution time of the test suite
can easily reach hours or days - if the tests are executed sequentially. Parallel execution allows to fit more tests into the same timeslot and thereby drastically reducing execution time of the entire test suite.

.Visualization of parallel test execution:

image:./images/grid2.png[
"My screenshot",width=480,
link="./images/grid2.png"]

.Selenium Grid has two main tasks:
* act as a load balancer for incoming requests from the client(s) and distribute the tests to the registered nodes
* act as a resource manager to match incoming capability requests with the available capabilities in the Grid (a capability could be a platform, version, browser etc.)


.Example architecture for a Selenium Grid:

image:./images/grid.png[
"My screenshot",width=480,
link="./images/grid.png"]

The nodes (on the right side) send a registration request to the Selenium Grid Hub, telling it their capability. This typically consists of OS, browser, browser version.
The client (left side) sends all tests along with so called Desired Capabilities to the Selenium Grid Hub as a central entry point. The Selenium Grid Hub now tries to match the desired capabilities
to the actually available capabilities. If there is a match, it forwards the test to the node that matches the capabilities. In addition, it has the ability to run tests in parallel by distributing them to all matched nodes.

.What is different about mobile automation?
.While there are of course differences between web and mobile automation, the core job ob a mobile automation tool is the same as for the web:
* find an element (i.e. button)
* interact with the element (i.e. click the button)

Therefore the JSON Wire protocol which was initially created for the web, also applies to the mobile space (except special gestures i.e. swipe).

Now after setting the stage, let's focus on introducing you to Selendroid and ios-driver.

== Biography Michael Palotas
In addition to his role as Head of Productivity & Test Engineering at eBay International, Michael Palotas is founder of Gridfusion Software Solutions,
a consultancy that focuses on test automation with open source toolsets and agile testing practices. Michael was a key driver behind the creation of Selenium
Grid and more recently the creation of Selendroid and ios-driver, two open source tools for automation of mobile native apps and the mobile web for Android
and IOS in a Selenium fashion. After working in various lead roles in software development and test for Ericsson, Nortel Networks and Intel in North America and
Europe, Michael joined eBay in 2004 and founded Gridfusion in 2011. Michael is a recognized expert in test engineering and test automation and has spoken at
many conferences and events around the world.


